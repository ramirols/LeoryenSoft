---
type Lang = "es" | "en";

const { lang = "es" } = Astro.props as { lang?: Lang };

const i18n: Record<
    Lang,
    {
        title: string;
        subtitle: string;
        nameLabel: string;
        namePlaceholder: string;
        emailLabel: string;
        emailPlaceholder: string;
        messageLabel: string;
        messagePlaceholder: string;
        hint: string;
        button: string;
        trust: string;
        whatsappIntro: string;
    }
> = {
    es: {
        title: "ContÃ¡ctanos y hagamos realidad tu proyecto",
        subtitle:
            "CuÃ©ntanos sobre tu idea, negocio o necesidad digital. Te responderemos en menos de 24 horas.",
        nameLabel: "Nombre completo",
        namePlaceholder: "Ej. Juan PÃ©rez",
        emailLabel: "Correo electrÃ³nico",
        emailPlaceholder: "correo@empresa.com",
        messageLabel: "CuÃ©ntanos sobre tu proyecto",
        messagePlaceholder:
            "Necesito una pÃ¡gina web, sistema, tienda online, etc.",
        hint: "Mientras mÃ¡s detalles, mejor podrÃ© ayudarte ðŸš€",
        button: "Enviar mensaje",
        trust: "ðŸ”’ Tu informaciÃ³n es confidencial. No spam, solo contacto directo.",
        whatsappIntro: "Hola ðŸ‘‹, soy",
    },
    en: {
        title: "Contact us and bring your project to life",
        subtitle:
            "Tell us about your idea, business, or digital needs. Weâ€™ll get back to you within 24 hours.",
        nameLabel: "Full name",
        namePlaceholder: "e.g. John Doe",
        emailLabel: "Email address",
        emailPlaceholder: "email@company.com",
        messageLabel: "Tell us about your project",
        messagePlaceholder: "I need a website, system, online store, etc.",
        hint: "The more details you share, the better I can help ðŸš€",
        button: "Send message",
        trust: "ðŸ”’ Your information is confidential. No spam, just direct contact.",
        whatsappIntro: "Hi ðŸ‘‹, Iâ€™m",
    },
};

const t = i18n[lang];
---

<section id="contacto" class="relative max-w-3xl mx-auto px-6 py-20">
    <!-- Header -->
    <header class="text-center mb-12 animate-fade-up">
        <h2 class="text-3xl md:text-4xl font-bold mb-4">
            {t.title}
        </h2>
        <p class="text-gray-600 max-w-xl mx-auto">
            {t.subtitle}
        </p>
    </header>

    <!-- Form -->
    <form
        id="contactForm"
        class="space-y-6 bg-white shadow-2xl p-8 md:p-10 rounded-3xl border animate-fade-up animation-delay-200"
    >
        <!-- Nombre -->
        <div>
            <label for="name" class="block text-sm font-medium mb-1">
                {t.nameLabel}
            </label>
            <input
                id="name"
                name="name"
                type="text"
                required
                minlength="3"
                placeholder={t.namePlaceholder}
                class="w-full rounded-xl border px-4 py-3 transition focus:outline-none focus:ring-2 focus:ring-blue-500"
            />
        </div>

        <!-- Email -->
        <div>
            <label for="email" class="block text-sm font-medium mb-1">
                {t.emailLabel}
            </label>
            <input
                id="email"
                name="email"
                type="email"
                required
                placeholder={t.emailPlaceholder}
                class="w-full rounded-xl border px-4 py-3 transition focus:outline-none focus:ring-2 focus:ring-blue-500"
            />
        </div>

        <!-- Mensaje -->
        <div>
            <label for="message" class="block text-sm font-medium mb-1">
                {t.messageLabel}
            </label>
            <textarea
                id="message"
                name="message"
                rows="5"
                required
                minlength="10"
                placeholder={t.messagePlaceholder}
                class="w-full rounded-xl border px-4 py-3 transition focus:outline-none focus:ring-2 focus:ring-blue-500"
            ></textarea>
            <p class="text-xs text-gray-500 mt-1">
                {t.hint}
            </p>
        </div>

        <!-- CTA -->
        <button
            type="submit"
            class="group relative w-full overflow-hidden rounded-xl bg-secondary py-3 font-semibold text-white transition hover:bg-secondary/80"
        >
            <span class="relative z-10">{t.button}</span>
            <span
                class="absolute inset-0 -translate-x-full bg-secondary/80 transition-transform duration-300 group-hover:translate-x-0"
            ></span>
        </button>

        <!-- Trust -->
        <p class="text-center text-xs text-gray-500 pt-2">
            {t.trust}
        </p>
    </form>
</section>

<script is:inline>
    document.addEventListener("DOMContentLoaded", () => {
        const form = document.getElementById("contactForm");
        if (!form) return;

        form.addEventListener("submit", (e) => {
            e.preventDefault();

            const data = new FormData(form);
            const name = data.get("name");
            const email = data.get("email");
            const message = data.get("message");

            const whatsappMessage = `
${`{t.whatsappIntro}`} *${name}*

ðŸ“§ Email: ${email}

ðŸ’¬ Message:
${message}
      `;

            const url = `https://wa.me/51997676432?text=${encodeURIComponent(
                whatsappMessage,
            )}`;
            window.open(url, "_blank");
        });
    });
</script>